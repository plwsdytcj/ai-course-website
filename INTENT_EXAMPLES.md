# 意图识别和处理示例

## 📊 当前支持的意图分类

### 🔧 工具意图（需要调用API）

#### 1️⃣ 查询余额意图

**用户可以这样说：**
```
✅ "余额"
✅ "我还有多少次"
✅ "剩余次数"
✅ "帮我查下账户"
✅ "还剩几次对话"
✅ "我的次数"
✅ "看看我还有多少"
✅ "账户信息"
```

**AI的处理：**
```
调用工具: getUserBalance()
返回数据: { credits: 50, messageCount: 10 }
AI回复: "您当前还有50次对话机会，已累计使用10次对话。"
```

---

#### 2️⃣ 查询套餐意图

**用户可以这样说：**
```
✅ "充值"
✅ "有哪些套餐"
✅ "价格表"
✅ "多少钱"
✅ "怎么收费"
✅ "充值价格"
✅ "套餐列表"
```

**AI的处理：**
```
调用工具: getRechargePackages()
AI回复: "我们提供3个充值套餐：
1. 1元50次 - 每次0.02元
2. 5元300次 - 每次0.017元（超值）
3. 10元700次 - 每次0.014元（最划算）"
```

---

#### 3️⃣ 创建订单意图

**用户可以这样说：**
```
✅ "充值 1"
✅ "我要1块钱的"
✅ "买50次对话"
✅ "我要充值套餐1"
✅ "给我来个1元的"
✅ "买第一个套餐"
```

**AI的处理：**
```
调用工具: createRechargeOrder({ package: '1' })
返回: 订单号、支付链接
AI回复: "订单已创建，请点击链接支付..."
```

---

#### 4️⃣ 查询历史意图

**用户可以这样说：**
```
✅ "充值记录"
✅ "之前买了几次"
✅ "历史订单"
✅ "消费记录"
✅ "我充过几次"
✅ "充值历史"
```

**AI的处理：**
```
调用工具: getPaymentHistory()
AI回复: "您的充值历史：
1. 2025-10-11 充值1元，获得50次
2. 2025-10-10 充值5元，获得300次"
```

---

### 💬 对话意图（不需要工具，AI直接回复）

#### 5️⃣ 打招呼

```
用户: "你好"
AI: "你好！我是AI课程助教，很高兴为您服务。"

用户: "hi"
AI: "Hi！有什么我能帮您的吗？"

用户: "在吗"
AI: "我一直在线！有什么需要帮助的吗？"
```

---

#### 6️⃣ 知识问答

```
用户: "什么是机器学习？"
AI: "机器学习是人工智能的一个重要分支，它让计算机能够从数据中学习规律..."

用户: "Python怎么学？"
AI: "学习Python建议按照以下路径：
1. 基础语法
2. 数据结构
3. 面向对象
..."

用户: "递归是什么？"
AI: "递归是一种编程技巧，函数调用自身来解决问题..."
```

---

#### 7️⃣ 学习辅导

```
用户: "这道题怎么做？1+1=?"
AI: "这是一道简单的加法题。1+1=2。"

用户: "帮我解释下冒泡排序"
AI: "冒泡排序是一种简单的排序算法，它重复地..."
```

---

#### 8️⃣ 闲聊

```
用户: "今天心情不好"
AI: "听起来您今天遇到了一些烦心事。学习也是调节心情的好方法，要不要聊聊课程相关的内容？"

用户: "谢谢你"
AI: "不客气！随时为您服务。"

用户: "你真棒"
AI: "谢谢夸奖！我会继续努力帮助您学习。"
```

---

#### 9️⃣ 求助

```
用户: "我不知道怎么用"
AI: "我来帮您！您可以：
- 发送"余额"查看剩余次数
- 发送"充值"查看充值套餐
- 直接问我学习问题
- 上传图片让我帮忙看

还有什么不清楚的吗？"

用户: "帮助"
AI: "我能帮您做这些：
📊 查询余额和使用记录
💰 充值对话次数
📚 解答学习问题
📷 看图回答问题
有什么需要的尽管说！"
```

---

## 🔄 意图匹配的优先级

```
用户输入
    ↓
┌─────────────────────────────────┐
│ 1. 检查固定关键词（最快）       │
│    "余额" → 直接返回           │
│    "充值" → 显示菜单           │
│    "充值 1" → 创建订单         │
└────────────┬────────────────────┘
             ↓ 没匹配到
┌─────────────────────────────────┐
│ 2. Function Calling (智能)     │
│    AI判断是否需要调用工具      │
│    - 需要 → 调用对应工具       │
│    - 不需要 → 直接对话         │
└─────────────────────────────────┘
```

---

## 💡 为什么这样设计？

### 快速通道 + 智能通道

```
固定关键词（快速通道）
- "余额" → 100ms响应
- 不调用AI，省钱省时

Function Calling（智能通道）
- "我还剩几次" → 3秒响应
- 调用AI理解意图
- 灵活但稍慢
```

**最佳实践：常用功能用快速通道，其他用智能通道**

---

## 🎯 意图总结

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━
工具意图（4个）:
  1. 查余额       ✅
  2. 查套餐       ✅
  3. 创建订单     ✅
  4. 查历史       ✅

对话意图（无限）:
  5. 打招呼       ✅
  6. 知识问答     ✅
  7. 学习辅导     ✅
  8. 闲聊         ✅
  9. 求助         ✅
  10. 任何其他问题 ✅
━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

**DeepSeek AI会自动判断：**
- 需要工具 → 调用对应的工具
- 不需要工具 → 直接对话

**这就是Function Calling的强大之处！** 🚀

需要我添加更多工具意图吗？比如：
- 查成绩
- 查课程表
- 预约答疑
- 打卡签到
